<!DOCTYPE html>
<html lang="en">
<head>
  <title>VU Education Lab AI Assistant</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="popup.css">
  <style>
    /* Adjust the width of the popup */
    body {
      width: 500px;
      min-width: 500px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <img src="images/icon128.png" alt="CTL Honingraat Logo" class="logo">
      <h1>AI Assistant for Teachers</h1>
      <div class="header-icons">
        <button id="settings-btn" title="Settings" aria-label="Settings" data-tooltip="Extension settings" class="gear-btn">‚öôÔ∏è</button>
      </div>
    </header>

    <!-- Authentication Section -->
    <div id="auth-section" style="display:none;">
      <div class="auth-container">
        <div class="auth-icon">üîí</div>
        <h2>VU Authentication Required</h2>
        <p>This extension is only available for VU Amsterdam and AmsterdamUMC users. Please sign in with your email address (@vu.nl or @amsterdamumc.nl).</p>
        <button id="sign-in-btn" class="auth-btn">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" style="width: 18px; height: 18px; margin-right: 8px;">
          Sign in with Google
        </button>
        <div id="auth-error" class="auth-error" style="display:none;"></div>
      </div>
    </div>

    <div id="features-section" class="hidden">
      <div class="tabs" role="tablist">
        <button class="tab-btn active" data-tab="summarize" role="tab" aria-selected="true" aria-controls="summarize">Summarize</button>
        <button class="tab-btn" data-tab="quiz" role="tab" aria-selected="false" aria-controls="quiz">Quiz</button>
        <button class="tab-btn" data-tab="explain" role="tab" aria-selected="false" aria-controls="explain">Explain</button>
        <button class="tab-btn" data-tab="suggest" role="tab" aria-selected="false" aria-controls="suggest">Teaching</button>
        <button class="tab-btn" data-tab="custom" role="tab" aria-selected="false" aria-controls="custom">Custom</button>
      </div>

      <div class="tab-content">
        <div id="summarize" class="tab-pane active" role="tabpanel" aria-labelledby="tab-summarize">
          <h2>Summarize Content</h2>
          <p>Generate a concise summary of the current page for lesson planning.</p>
          <div class="input-group">
            <select id="summary-length" aria-label="Summary length">
              <option value="short">Short (~100 words)</option>
              <option value="medium" selected>Medium (~250 words)</option>
              <option value="long">Long (~500 words)</option>
            </select>
            <button id="generate-summary" data-tooltip="Generate a summary of the current page">Generate</button>
          </div>
        </div>

        <div id="quiz" class="tab-pane" role="tabpanel" aria-labelledby="tab-quiz">
          <h2>Generate Quiz Questions</h2>
          <p>Get quiz questions based on the current page content.</p>
          <div class="input-group">
            <select id="question-type" aria-label="Question type">
              <option value="multiple-choice">Multiple Choice</option>
              <option value="true-false">True/False</option>
              <option value="short-answer">Short Answer</option>
              <option value="mixed" selected>Mixed</option>
            </select>
            <input type="number" id="question-count" min="1" max="10" value="5" placeholder="Number of questions" aria-label="Number of questions">
            <select id="quiz-difficulty" aria-label="Quiz difficulty">
              <option value="low">Low</option>
              <option value="medium" selected>Medium</option>
              <option value="hard">Hard</option>
            </select>
            <button id="generate-quiz" data-tooltip="Generate quiz questions from page content">Generate</button>
          </div>
        </div>

        <div id="explain" class="tab-pane" role="tabpanel" aria-labelledby="tab-explain">
          <h2>Explain Complex Topics</h2>
          <p>Get clear explanations of difficult concepts.</p>
          <div class="input-group">
            <input type="text" id="topic-input" placeholder="Enter specific topic or leave blank for auto-detection" aria-label="Topic to explain">
            <select id="explanation-level" aria-label="Explanation level">
              <option value="beginner">Beginner</option>
              <option value="intermediate" selected>Intermediate</option>
              <option value="advanced">Advanced</option>
            </select>
            <button id="generate-explanation" data-tooltip="Get explanations of complex topics">Explain</button>
          </div>
        </div>

        <div id="suggest" class="tab-pane" role="tabpanel" aria-labelledby="tab-suggest">
          <h2>Teaching Suggestions</h2>
          <p>Get teaching tips and activity ideas based on the current page content.</p>
          <div class="input-group">
            <select id="teaching-format" aria-label="Teaching format">
              <option value="lecture">Lecture</option>
              <option value="discussion" selected>Discussion</option>
              <option value="activity">Activity</option>
              <option value="assessment">Assessment</option>
              <option value="essay">Essay</option>
            </select>
            <button id="generate-suggestions" data-tooltip="Get teaching activity suggestions">Get Suggestions</button>
          </div>
        </div>

        <div id="custom" class="tab-pane" role="tabpanel" aria-labelledby="tab-custom">
          <h2>Custom Prompt</h2>
          <p>Ask any question or request about the current page content.</p>
          <div class="input-group custom-prompt-group">
            <textarea id="custom-prompt" placeholder="Enter your custom prompt or question here..." aria-label="Custom prompt" rows="3"></textarea>
            <button id="generate-custom" data-tooltip="Generate response using your custom prompt">Ask</button>
          </div>
          <div class="prompt-templates">
            <p class="template-label">Quick templates:</p>
            <div class="template-buttons">
              <button class="template-btn" 
                data-prompt="Generate 5 engaging discussion questions for class based on this content. For each question: make it open-ended, thought-provoking, and connected to real-world situations. Include brief guidance on what makes a strong student response." 
                data-prompt-nl="Genereer 5 boeiende discussievragen voor in de klas gebaseerd op deze inhoud. Maak elke vraag open, tot nadenken stemmend, en verbonden met praktijksituaties. Voeg korte richtlijnen toe over wat een sterk studentantwoord is.">Discussion Questions</button>
              <button class="template-btn" 
                data-prompt="Identify and define 5-8 key terms or concepts from this content that students must understand. For each term provide: (1) a clear, jargon-free definition, (2) an example in context, and (3) why it's important for students to know." 
                data-prompt-nl="Identificeer en definieer 5-8 kernbegrippen of concepten uit deze inhoud die studenten moeten begrijpen. Geef voor elke term: (1) een duidelijke, jargonvrije definitie, (2) een voorbeeld in context, en (3) waarom studenten dit moeten weten.">Key Terms</button>
              <button class="template-btn" 
                data-prompt="Provide 3 concrete, real-world examples or applications that illustrate the main concepts in this content. Make them relatable to university students' lives, current events, or future careers. Explain how each example connects to the theory." 
                data-prompt-nl="Geef 3 concrete, praktijkvoorbeelden of toepassingen die de hoofdconcepten in deze inhoud illustreren. Maak ze herkenbaar voor het leven van universiteitsstudenten, actuele gebeurtenissen, of toekomstige carri√®res. Leg uit hoe elk voorbeeld verbonden is met de theorie.">Real Examples</button>
              <button class="template-btn" 
                data-prompt="Create 5 quick check-for-understanding questions (multiple choice or short answer) to assess if students grasped the main concepts. Include correct answers and brief explanations. These should be simple enough to use mid-lecture." 
                data-prompt-nl="Maak 5 snelle begripsvragen (meerkeuze of kort antwoord) om te beoordelen of studenten de hoofdconcepten begrepen hebben. Voeg correcte antwoorden en korte uitleg toe. Deze moeten eenvoudig genoeg zijn om tijdens het college te gebruiken.">Quick Check</button>
              <button class="template-btn" 
                data-prompt="Design an engaging 5-minute opening activity or discussion starter to hook students' attention before teaching this content. Include: (1) the hook question or activity, (2) why it will engage students, and (3) how to transition to the main content." 
                data-prompt-nl="Ontwerp een boeiende openingsactiviteit of discussiestarter van 5 minuten om de aandacht van studenten te trekken voordat je deze inhoud behandelt. Voeg toe: (1) de haak-vraag of activiteit, (2) waarom het studenten zal boeien, en (3) hoe over te gaan naar de hoofdinhoud.">Lesson Hook</button>
              <button class="template-btn" 
                data-prompt="Identify 3-4 common misconceptions or mistakes students typically make when learning this content. For each: (1) describe the misconception, (2) explain why students think this, (3) provide the correct understanding, and (4) suggest a teaching strategy to address it." 
                data-prompt-nl="Identificeer 3-4 veelvoorkomende misvattingen of fouten die studenten maken bij het leren van deze inhoud. Voor elk: (1) beschrijf de misvatting, (2) leg uit waarom studenten dit denken, (3) geef het correcte begrip, en (4) stel een onderwijsstrategie voor om het aan te pakken.">Misconceptions</button>
            </div>
          </div>
        </div>
      </div>

      <div id="result-wrapper">
        <div id="result-container">
          <div id="loading" class="hidden" aria-live="polite">
            <div class="spinner" role="status" aria-label="Loading"></div>
            <p>Processing your request...</p>
          </div>
          <div id="result-content" aria-live="polite"></div>
          <div class="result-actions hidden">
            <button id="copy-result" data-tooltip="Copy content to clipboard">Copy to Clipboard</button>
            <button id="export-pdf" data-tooltip="Export content as PDF">Export PDF</button>
          </div>
        </div>
        <div id="result-fade" class="hidden"></div>
        <button id="expand-toggle" class="hidden" aria-label="Show more content">Show more ‚ñº</button>
      </div>
    </div>

    <footer>
      <p>Developed by Vrije Universiteit Amsterdam</p>
    </footer>
  </div>

  <script src="jspdf.umd.min.js"></script>
  <script src="auth.js"></script>
  <script src="api.js"></script>
  <script src="iframe-bridge.js"></script>
  <script src="popup.js"></script>
</body>
</html>
